<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨å°è¦½</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Serif TC', serif; }
        .transition-transform { transition: transform 0.3s ease; }
        #app-content.h-full { height: 100%; }

        /* 1. é¦–é èƒŒæ™¯åœ–æ¨£å¼ */
        .landing-bg {
    /* åœ–ç‰‡è¨­å®šä¸è®Š */
    background-image: url('./landing-bg.jpg'); 
    background-size: cover;
    background-position: bottom center;
    background-attachment: fixed;
    
    /* VVVV é—œéµä¿®æ­£ï¼šç¢ºä¿åœ–ç‰‡ä¸æœƒè¢«å…¶ä»–èƒŒæ™¯è‰²é®æ“‹ VVVV */
    background-color: transparent !important; 
    /* ^^^^ é—œéµä¿®æ­£ ^^^^ */
}
        
        /* åœ–ç‰‡è£åˆ‡è¨­å®š */
        .img-cover-top { object-fit: cover; object-position: center top; }
        .img-cover-bottom { object-fit: cover; object-position: center bottom; }
        .img-cover-center { object-fit: cover; object-position: center center; }

        /* åœ“åœˆåœ–ç¤ºæ¨£å¼ */
        .circle-icon {
            display: inline-flex; align-items: center; justify-content: center;
            width: 2rem; height: 2rem; border-radius: 9999px;
            background-color: #06B6D4; color: #F8FAFC;
            font-size: 1rem; font-weight: bold; flex-shrink: 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'bg-main': '#0A192F',
                        'bg-card': '#172A46',
                        'bg-mid-card': '#34496b',
                        'text-light': '#F8FAFC',
                        'accent': '#06B6D4',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-bg-main text-text-light min-h-screen flex flex-col">

    <nav class="sticky top-0 z-10 bg-bg-card shadow-xl border-b-2 border-accent/50">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <button id="back-btn" class="flex items-center text-text-light hover:text-accent transition duration-150 hidden" onclick="goBack()">
                    <svg class="h-6 w-6 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                    <span class="text-base font-medium hidden sm:inline">è¿”å›</span>
                </button>
                <div class="flex-shrink-0 flex-grow text-center sm:text-left">
                    <span id="nav-title" class="text-xl font-extrabold text-text-light transition duration-300">æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨å°è¦½</span>
                </div>
                <div class="w-12"></div>
            </div>
        </div>
    </nav>

    <main class="flex-grow p-4 sm:p-8 max-w-4xl mx-auto w-full">
        <div id="app-content" class="bg-bg-card p-6 sm:p-10 rounded-3xl shadow-2xl border border-gray-700 min-h-[60vh] transition-transform">
            </div>
    </main>

    <footer class="bg-bg-card/50 py-6 mt-auto border-t border-gray-700">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p class="text-text-light text-sm">Â© 2025 æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨ã€‚</p>
        </div>
    </footer>

    <script>
        // è³‡æ–™è¨­å®š
        const XIANGSHAN_MAP_URL = "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d116315.65775432021!2d120.91698650000001!3d24.84716155!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x34685e1b21239c4d%3A0x8683c3486c4f305!2z5paw5puy5rW35bGx6a-s56ef!5e0!3m2!1szh-TW!2stw!4v1701700000000!5m2!1szh-TW!2stw";

        const MUSEUM_DATA = {
            "æµ·èˆ‡ç”Ÿæ´»": {
                "æµ·å±±æ¼æ¸¯": { description: "æµ·å±±æ¼æ¸¯æ˜¯æ–°ç«¹è‘—åçš„æ¼æ¸¯ä¹‹ä¸€ï¼Œè¦‹è­‰äº†åœ¨åœ°æ¼æ¥­çš„è®Šé·èˆ‡ç™¼å±•ï¼Œæ›´æ˜¯è§€å¯Ÿå¤•é™½èˆ‡æµ·æ™¯çš„çµ•ä½³åœ°é»ã€‚", timing: "ğŸŒ… æœ€ä½³æ™‚é–“ï¼šæ—¥è½æ™‚åˆ†ã€‚", map_url: XIANGSHAN_MAP_URL },
                "å®šç½®æ¼å ´": { description: "å®šç½®æ¼å ´æ˜¯ä¸€ç¨®æ°¸çºŒçš„æ¼æ’ˆæ–¹å¼ï¼Œåˆ©ç”¨åœ°åˆ©èˆ‡æ½®æµæ•æ‰æ´„æ¸¸é­šé¡ã€‚", timing: "ğŸŸ æ¼ç²è²©è³£ï¼šæ¯å¤©ä¸‹åˆ 2 é»å·¦å³ã€‚", map_url: XIANGSHAN_MAP_URL },
                "é¦™å±±æ¿•åœ°": { description: "é¦™å±±æ¿•åœ°æ˜¯é‡è¦çš„ç”Ÿæ…‹ä¿è­·å€ï¼Œæ“æœ‰è±å¯Œçš„åº•æ£²ç”Ÿç‰©èˆ‡æ°´é³¥è³‡æºã€‚", timing: "ğŸ¦¢ è§€å¯Ÿç”Ÿæ…‹ï¼šé€€æ½®å‰å¾Œ 2 å°æ™‚ã€‚", map_url: XIANGSHAN_MAP_URL }
            },
            "ä¿¡ä»°èˆ‡æ–‡åŒ–": {
                "æ°´è“®å®®": { description: "æ°´è“®å®®æ˜¯ç•¶åœ°é‡è¦çš„ä¿¡ä»°ä¸­å¿ƒï¼Œä¾›å¥‰åª½ç¥–ï¼Œå®ˆè­·è‘—è¨æµ·äººçš„å¹³å®‰ã€‚", timing: "ğŸ™ åƒæ‹œæ™‚é–“ï¼šç™½å¤©æ™‚æ®µã€‚", map_url: XIANGSHAN_MAP_URL },
                "é¦™å±±å¤©åå®®": { description: "æ­·å²æ‚ ä¹…çš„é¦™å±±å¤©åå®®ï¼Œå…¶å»ºç¯‰å·¥è—èˆ‡æ­·å²åƒ¹å€¼ä»£è¡¨è‘—å®¢å®¶èˆ‡ç¦ä½¬æ–‡åŒ–èåˆçš„è»Œè·¡ã€‚", timing: "ğŸ™ åƒæ‹œæ™‚é–“ï¼šç™½å¤©æ™‚æ®µã€‚", map_url: XIANGSHAN_MAP_URL }
            },
            "åœ°æ–¹ç”¢æ¥­": {
                "èŒ¶èŠ±åœ’": { description: "æ–°ç«¹çš„æ°£å€™é©åˆèŒ¶èŠ±ç”Ÿé•·ï¼ŒèŒ¶èŠ±åœ’ä¸åƒ…æ˜¯è§€å…‰æ™¯é»ï¼Œæ›´æ˜¯é‡è¦çš„èŠ±å‰ç”¢æ¥­åŸºåœ°ã€‚", timing: "ğŸŒ¸ æœ€ä½³èŠ±æœŸï¼š11 æœˆè‡³éš”å¹´ 3 æœˆã€‚", map_url: XIANGSHAN_MAP_URL },
                "å’–å•¡è±†": { description: "æµ·å±±ç¤¾å€è‡ªå®¶çƒ˜ç„™çš„å’–å•¡è±†ï¼Œæ˜¯ç”±ç¤¾å€çš„ã€Œè€è‡˜è‚‰ã€å€‘è¦ªæ‰‹æ²–æ³¡çš„åœ¨åœ°é¢¨å‘³ã€‚", timing: "â˜• è³¼è²·æ™‚é–“ï¼šè«‹ä¾æµ·å±±ç¤¾å€ç™¼å±•å”æœƒç‡Ÿæ¥­æ™‚é–“å‰å¾€ã€‚", map_url: XIANGSHAN_MAP_URL },
                "å®šç½®æ¼å ´": { description: "ï¼ˆå†æ¬¡æåŠï¼‰å®šç½®æ¼å ´é™¤äº†æ˜¯æ¼æ’ˆæ–¹å¼ï¼Œä¹Ÿæ˜¯åœ°æ–¹ç¶“æ¿Ÿç”¢æ¥­çš„ä¸€ç’°ã€‚", timing: "ğŸŸ æ¼ç²è²©è³£ï¼šæ¯å¤©ä¸‹åˆ 2 é»å·¦å³ã€‚", map_url: XIANGSHAN_MAP_URL },
                "é€²å£«ç‰§å ´": { description: "é€²å£«ç‰§å ´æ˜¯çŸ¥åçš„ä¹³ç‰›ç‰§å ´ï¼Œæä¾›æ–°é®®ä¹³è£½å“ã€‚", timing: "ğŸ¥› ç‡Ÿæ¥­æ™‚é–“ï¼šè«‹æŸ¥è©¢ç‰§å ´å®˜æ–¹å…¬å‘Šã€‚", map_url: XIANGSHAN_MAP_URL }
            },
            "å¤šæ—ç¾¤å…±æ§‹": {
                "é‚£é­¯ç£": { description: "ã€Œé‚£é­¯ç£ã€ä»£è¡¨è‘—å¤šæ—ç¾¤èåˆçš„ç²¾ç¥ï¼Œæ˜¯ç¤¾å€æ´»å‹•èˆ‡äº¤æµçš„ä¸­å¿ƒã€‚", timing: "ğŸ¤ æ´»å‹•æ™‚é–“ï¼šè«‹æŸ¥è©¢åœ¨åœ°ç¤¾å€å…¬å‘Šã€‚", map_url: XIANGSHAN_MAP_URL },
                "ç™¼å±•å”æœƒä¸­å¿ƒ": { description: "åœ°æ–¹ç™¼å±•å”æœƒä¸­å¿ƒæ˜¯æ¨å‹•ç¤¾å€ç‡Ÿé€ å’Œæ–‡åŒ–å‚³æ‰¿çš„æ ¸å¿ƒçµ„ç¹”ã€‚", timing: "â° å»ºè­°æ™‚é–“ï¼šè«‹æ–¼é€±é–“ä¸Šç­æ™‚é–“å‰å¾€ã€‚", map_url: XIANGSHAN_MAP_URL }
            }
        };

        const CATEGORY_ICONS = {
            "æµ·èˆ‡ç”Ÿæ´»": `<svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8v8A4 4 4 0 0 1 8 16V8a4 4 4 0 0 1 8 0z"/><path d="M12 21V3"/><path d="M17 17l4 4"/><path d="M7 17l-4 4"/></svg>`,
            "ä¿¡ä»°èˆ‡æ–‡åŒ–": `<svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3a6 6 0 0 0 9 7.42V20a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V10.42A6 6 0 0 0 12 3Z"/><path d="M9 22V8.5c0-.9.4-1.5 1-1.5c.6 0 1 .4 1 1v4m-1 0h2m-1 0v-4c0-.6.4-1 1-1h2c.6 0 1 .4 1 1v4"/></svg>`,
            "åœ°æ–¹ç”¢æ¥­": `<svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 10v4c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2v-4"/><path d="M12 16v6"/><path d="M12 2v4"/><path d="M17 6h3a2 2 0 0 1 2 2v2"/><path d="M7 6H4a2 2 0 0 0-2 2v2"/><path d="M22 14v2a2 2 0 0 1-2 2h-3"/><path d="M2 14v2a2 2 0 0 0 2 2h3"/></svg>`,
            "å¤šæ—ç¾¤å…±æ§‹": `<svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>`
        };

        const appContent = document.getElementById('app-content');
        const navTitle = document.getElementById('nav-title');
        const backBtn = document.getElementById('back-btn');
        let historyStack = [];
        let currentView = { id: 'landing', data: null };

        // é é¢å°èˆªæ ¸å¿ƒå‡½å¼
        function navigateTo(viewId, data = null) {
            // èƒŒæ™¯åˆ‡æ›é‚è¼¯
            if (viewId === 'landing') {
                document.body.classList.add('landing-bg', 'bg-transparent');
                document.body.classList.remove('bg-bg-main');
            } else {
                document.body.classList.remove('landing-bg', 'bg-transparent');
                document.body.classList.add('bg-bg-main');
            }

            if (currentView.id !== viewId && viewId !== 'landing') {
                historyStack.push({ view: currentView.id, data: currentView.data });
            }
            
            // æ¸…ç©ºå®¹å™¨
            appContent.classList.remove('flex', 'items-center', 'justify-center', 'h-full');
            appContent.innerHTML = '';
            
            currentView.id = viewId;
            currentView.data = data;

            // æ ¹æ“š viewId æ¸²æŸ“å°æ‡‰å…§å®¹
            switch (viewId) {
                case 'landing': renderLandingView(); break;
                case 'home': renderHomeView(); break;
                case 'category': renderCategoryView(data); break;
                case 'detail': renderDetailView(data); break;
                case 'routePlanningEntry': renderRoutePlanningEntry(data); break;
                default: renderLandingView();
            }
            updateNavigation(viewId, data);
        }

        // è¼”åŠ©å‡½å¼ï¼šé–‹å•Ÿè·¯ç·šè¦åŠƒ (è§£æ±º HTML å±¬æ€§å¼•è™Ÿè¡çªå•é¡Œ)
        function openRoutePlanning(categoryName) {
            navigateTo('routePlanningEntry', { categoryName: categoryName });
        }

        function goBack() {
            if (historyStack.length > 0) {
                const previousState = historyStack.pop();
                currentView.id = previousState.view;
                currentView.data = previousState.data;
                appContent.innerHTML = '';
                
                // èƒŒæ™¯åˆ‡æ›é‚è¼¯
                if (currentView.id === 'landing') {
                    document.body.classList.add('landing-bg', 'bg-transparent');
                    document.body.classList.remove('bg-bg-main');
                    appContent.classList.add('flex', 'items-center', 'justify-center', 'h-full');
                } else {
                    document.body.classList.remove('landing-bg', 'bg-transparent');
                    document.body.classList.add('bg-bg-main');
                    appContent.classList.remove('flex', 'items-center', 'justify-center', 'h-full');
                }

                switch (currentView.id) {
                    case 'landing': renderLandingView(); break;
                    case 'home': renderHomeView(); break;
                    case 'category': renderCategoryView(currentView.data); break;
                    case 'detail': renderDetailView(currentView.data); break;
                    case 'routePlanningEntry': renderRoutePlanningEntry(currentView.data); break;
                    default: renderLandingView();
                }
                updateNavigation(currentView.id, currentView.data);
            }
        }

        function updateNavigation(viewId, data) {
            backBtn.classList.add('hidden'); // é è¨­éš±è—
            if (viewId === 'landing') {
                navTitle.textContent = "æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨";
                historyStack = [];
            } else if (viewId === 'home') {
                navTitle.textContent = "æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨ï¼å¾é¦™å±±è»Šç«™å‡ºç™¼";
            } else if (viewId === 'category') {
                navTitle.textContent = data.categoryName;
                backBtn.classList.remove('hidden');
            } else if (viewId === 'detail') {
                navTitle.textContent = data.locationName;
                backBtn.classList.remove('hidden');
            } else if (viewId === 'routePlanningEntry') {
                navTitle.textContent = `${data.categoryName} - è·¯ç·šè¦åŠƒ`;
                backBtn.classList.remove('hidden');
            }
        }

        // --- View Renders ---

        function renderLandingView() {
            appContent.classList.add('flex', 'items-center', 'justify-center', 'h-full');
            const content = `
                <header class="text-center p-8 rounded-2xl bg-bg-card/90 backdrop-blur-sm shadow-2xl">
                    <h1 class="text-5xl sm:text-6xl font-extrabold text-text-light mb-6">æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨</h1>
                    <p class="text-xl text-text-light mb-12">æ¢ç´¢é¦™å±±åœ°å€è±å¯Œçš„ç”Ÿæ…‹ã€æ­·å²èˆ‡äººæ–‡è„ˆçµ¡ã€‚</p>
                    <button onclick="navigateTo('home')" class="inline-flex items-center py-4 px-10 text-xl font-bold rounded-full shadow-2xl text-text-light bg-accent hover:bg-teal-400 transition duration-300 transform hover:scale-[1.05] active:scale-100 ring-4 ring-accent/50 ring-offset-bg-card ring-offset-2">
                        å¾é¦™å±±è»Šç«™å‡ºç™¼
                        <svg class="h-6 w-6 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                    </button>
                </header>
            `;
            appContent.innerHTML = content;
        }
        
        function renderHomeView() {
            const header = `
                <header class="text-center mb-12">
                    <h1 class="text-4xl sm:text-5xl font-extrabold text-text-light mb-2">é¸æ“‡æƒ³è¦çš„ä¸»é¡Œ</h1>
                    <p class="text-lg text-text-light">é»æ“Šä¸»é¡Œå¡ç‰‡ï¼Œæ·±å…¥æ¢ç´¢æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨çš„æ ¸å¿ƒåƒ¹å€¼ã€‚</p>
                </header>
            `;
            appContent.insertAdjacentHTML('beforeend', header);

            const categories = Object.keys(MUSEUM_DATA);
            const categorySection = document.createElement('div');
            categorySection.className = 'grid grid-cols-1 md:grid-cols-2 gap-8 mb-16';
            
            categories.forEach(category => {
                const icon = CATEGORY_ICONS[category] || '';
                const button = document.createElement('button');
                button.className = 'flex flex-col items-center justify-center p-8 text-center rounded-2xl shadow-xl border-t-8 border-accent bg-bg-mid-card text-text-light hover:bg-bg-mid-card/80 transition duration-300 transform hover:scale-[1.03] active:scale-100';
                button.innerHTML = `<div class="text-text-light mb-3">${icon}</div><span class="text-2xl font-bold">${category}</span><p class="text-base text-text-light mt-1">é»æ“Šé€²å…¥ ${category} ä¸»é¡Œ</p>`;
                button.onclick = () => navigateTo('category', { categoryName: category });
                categorySection.appendChild(button);
            });
            appContent.appendChild(categorySection);

            // ç•™è¨€æ¿å€å¡Š
            const messageBoardSection = `
                <section class="p-8 bg-bg-mid-card/50 rounded-2xl text-text-light shadow-2xl border border-accent/30">
                    <h2 class="text-3xl font-bold mb-6 text-center border-b border-accent/50 pb-3">ğŸ’¬ ç•™è¨€æ¿èˆ‡å»ºè­°å€</h2>
                    <form id="message-form" onsubmit="handleMessageSubmit(event)" class="space-y-4">
                        <div>
                            <label for="message-name" class="block text-lg font-medium text-text-light mb-2">æ‚¨çš„åç¨± (é¸å¡«):</label>
                            <input type="text" id="message-name" placeholder="åŒ¿åè¨ªå®¢" class="w-full p-3 rounded-lg border border-gray-600 bg-bg-card text-text-light placeholder-gray-500 focus:ring-accent focus:border-accent" />
                        </div>
                        <div>
                            <label for="message-content" class="block text-lg font-medium text-text-light mb-2">æ‚¨çš„ç•™è¨€/å»ºè­°:</label>
                            <textarea id="message-content" rows="4" required placeholder="è«‹åˆ†äº«æ‚¨çš„åƒè§€å¿ƒå¾—æˆ–å»ºè­°..." class="w-full p-3 rounded-lg border border-gray-600 bg-bg-card text-text-light placeholder-gray-500 focus:ring-accent focus:border-accent"></textarea>
                        </div>
                        <button type="submit" class="w-full flex items-center justify-center py-3 px-6 text-lg font-bold rounded-xl shadow-lg text-text-light bg-accent hover:bg-teal-400 transition duration-300 transform hover:scale-[1.01] active:scale-100 ring-2 ring-offset-2 ring-accent/50 ring-offset-bg-card">
                            é€å‡ºç•™è¨€
                        </button>
                    </form>
                </section>
            `;
            appContent.insertAdjacentHTML('beforeend', messageBoardSection);
        }

        function renderCategoryView(data) {
            const { categoryName } = data;
            const locations = MUSEUM_DATA[categoryName] || {};
            
            const header = `<header class="mb-10"><h1 class="text-3xl font-extrabold text-text-light mb-2">${categoryName}</h1><p class="text-lg text-text-light">è«‹é¸æ“‡æ‚¨æƒ³æ·±å…¥äº†è§£çš„åœ°é»ã€‚</p></header>`;
            appContent.insertAdjacentHTML('beforeend', header);
            
            const listContainer = document.createElement('div');
            listContainer.className = 'space-y-4';
            Object.keys(locations).forEach(locationName => {
                const button = document.createElement('button');
                button.className = 'flex items-center justify-between w-full p-5 text-left text-xl font-semibold rounded-xl shadow-md border border-gray-700 bg-bg-mid-card text-text-light hover:bg-bg-mid-card/80 hover:border-accent transition duration-200 transform hover:translate-x-1';
                button.innerHTML = `<span>${locationName}</span><svg class="h-6 w-6 ml-2 text-text-light" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>`;
                button.onclick = () => navigateTo('detail', { categoryName, locationName, detailsObject: locations[locationName] });
                listContainer.appendChild(button);
            });
            appContent.appendChild(listContainer);

            // è·¯ç·šè¦åŠƒæŒ‰éˆ• (ä½¿ç”¨æ–°å‡½å¼ openRoutePlanning é¿å…å¼•è™ŸéŒ¯èª¤)
            if (['åœ°æ–¹ç”¢æ¥­', 'æµ·èˆ‡ç”Ÿæ´»', 'ä¿¡ä»°èˆ‡æ–‡åŒ–', 'å¤šæ—ç¾¤å…±æ§‹'].includes(categoryName)) { 
                const routeButtonHtml = `
                    <div class="pt-6">
                        <button onclick="openRoutePlanning('${categoryName}')"
                                class="flex items-center justify-center w-full p-4 text-xl font-bold rounded-xl shadow-2xl text-text-light bg-accent hover:bg-teal-400 transition duration-300 transform hover:scale-[1.01] active:scale-100 ring-4 ring-accent/50 ring-offset-bg-card ring-offset-2">
                            <svg class="h-6 w-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l3-3m0 0l3 3m-3-3v-5m0 0v-5m0 5h5m-5 0h-5m5 0a9 9 0 110-18 9 9 0 010 18z"></path></svg>
                            è¦åŠƒ ${categoryName} è·¯ç·š
                        </button>
                        <p class="text-sm text-center text-gray-400 mt-2">é»æ“Šé€²å…¥è·¯ç·šè¦åŠƒå…¥å£ï¼Œé¸æ“‡ç›®çš„åœ°ã€‚</p>
                    </div>
                `;
                appContent.insertAdjacentHTML('beforeend', routeButtonHtml);
            }
        }

        function renderDetailView(data) {
    const { locationName, detailsObject } = data;
    const detail = detailsObject.description;
    const timing = detailsObject.timing;
    // VVVV ç¢ºä¿é€™è¡Œå­˜åœ¨ä¸¦æ­£ç¢º VVVV
    const mapUrl = detailsObject.map_url; // å¾è³‡æ–™ç‰©ä»¶ä¸­å–å¾—åœ°åœ– URL
    // ^^^^ ç¢ºä¿é€™è¡Œå­˜åœ¨ä¸¦æ­£ç¢º ^^^^

    let imageUrl = '';
    let imageClass = 'img-cover-top';
    
    // åœ–ç‰‡é¸æ“‡é‚è¼¯
    if (locationName === 'æµ·å±±æ¼æ¸¯') { imageUrl = 'IMG_8277.jpg'; imageClass = 'img-cover-bottom'; }
    else if (locationName === 'å®šç½®æ¼å ´') { imageUrl = 'IMG_0030.jpg'; imageClass = 'img-cover-center'; }
    else if (locationName === 'èŒ¶èŠ±åœ’') { imageUrl = 'store_teaflower.jpg'; imageClass = 'img-cover-bottom'; }
    else if (locationName === 'å’–å•¡è±†') { imageUrl = 'store_coffee.jpg'; imageClass = 'img-cover-bottom'; }
    else if (locationName === 'é€²å£«ç‰§å ´') { imageUrl = 'store_jinshi.jpg'; imageClass = 'img-cover-center'; }
    else { imageUrl = `https://placehold.co/800x400/34496b/ffffff?text=${locationName}`; }

    let imageHtml = `
        <img src="${imageUrl}" alt="${locationName}" class="w-full h-64 sm:h-80 rounded-xl shadow-lg ${imageClass}" onerror="this.src='https://placehold.co/800x400/34496b/ffffff?text=åœ–ç‰‡è¼‰å…¥å¤±æ•—';">
    `;

    let timingHtml = '';
    if (timing) {
        timingHtml = `
            <h2 class="text-2xl font-bold text-text-light pt-4 border-t border-gray-700">ğŸ§­ æœ€ä½³åƒè§€æ™‚é–“</h2>
            <div class="p-4 bg-accent/20 border-l-4 border-accent rounded-xl text-lg shadow-md">
                <p class="text-text-light">${timing}</p>
            </div>
        `;
    }
    
    // é—œéµçš„åœ°åœ– HTML å€å¡Š
    let mapHtml = '';
    if (mapUrl) {
        mapHtml = `
            <h2 class="text-2xl font-bold text-text-light pt-4 border-t border-gray-700">ğŸ—ºï¸ åœ°é»åœ°åœ–</h2>
            <div class="h-80 w-full overflow-hidden rounded-xl shadow-xl border-4 border-accent/50 bg-bg-mid-card">
                <iframe src="${mapUrl}" // é€™è£¡ä½¿ç”¨æ­£ç¢ºçš„ mapUrl
                        width="100%" height="100%" style="border:0;" 
                        allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade" 
                        class="rounded-lg">
                </iframe>
            </div>
            <p class="text-sm text-gray-400 italic mt-2">åœ°åœ–é¡¯ç¤ºç‚ºæ¦‚ç•¥ä½ç½®ï¼Œé»æ“Šé€²å…¥Googleåœ°åœ–å¯æŸ¥çœ‹è·¯ç·šã€‚</p>
        `;
    }
    
    const content = `
        <header class="mb-8 border-b-2 border-accent/50 pb-4">
            <h1 class="text-4xl font-extragold text-text-light mb-2">${locationName}</h1>
            <p class="text-lg text-text-light font-medium">ä¸»é¡Œåˆ†é¡ï¼š${data.categoryName}</p>
        </header>
        
        <div class="text-lg leading-relaxed text-text-light space-y-6">
            ${imageHtml}
            
            <h2 class="text-2xl font-bold text-text-light pt-4 border-t border-gray-700">åœ°é»ä»‹ç´¹</h2>
            <p class="text-text-light">${detail}</p>
            
            ${timingHtml}
            
            ${mapHtml} <div class="p-4 bg-yellow-900/30 border-l-4 border-yellow-600 rounded-xl italic text-base shadow-sm">
                <p class="font-semibold text-yellow-300 mb-1">ğŸ’¡ ç·¨è¼¯æç¤ºï¼š</p>
                <p class="text-yellow-400">æ‚¨å¯ä»¥ç·¨è¼¯ç¨‹å¼ç¢¼ä¸­çš„ "MUSEUM_DATA" ä¾†ä¿®æ”¹é€™æ®µä»‹ç´¹æ–‡å­—æˆ–æ™‚é–“è³‡è¨Šã€‚</p>
            </div>
        </div>
    `;
    appContent.insertAdjacentHTML('beforeend', content);
}

        function renderRoutePlanningEntry(data) {
            const { categoryName } = data;
            const locations = MUSEUM_DATA[categoryName] || {};
            
            let optionsHtml = '<option value="" disabled selected>è«‹é¸æ“‡ä¸€å€‹ç›®çš„åœ°...</option>';
            Object.keys(locations).forEach(loc => {
                optionsHtml += `<option value="${loc}">${loc}</option>`;
            });

            const content = `
                <header class="mb-10 text-center">
                    <h1 class="text-3xl font-extrabold text-text-light mb-4">${categoryName} - è·¯ç·šè¦åŠƒ</h1>
                    <p class="text-lg text-text-light">é¸æ“‡æ‚¨çš„ç›®çš„åœ°ï¼Œæˆ‘å€‘å°‡ç‚ºæ‚¨é–‹å•Ÿå°èˆªã€‚</p>
                </header>

                <div class="max-w-md mx-auto bg-bg-mid-card p-8 rounded-2xl shadow-2xl border border-gray-700">
                    <div class="mb-6">
                        <label for="destination-select" class="block text-lg font-medium text-text-light mb-2">ç›®çš„åœ°</label>
                        <select id="destination-select" class="w-full p-4 rounded-xl border border-gray-600 bg-bg-card text-text-light focus:ring-4 focus:ring-accent/50 focus:border-accent appearance-none text-lg">
                            ${optionsHtml}
                        </select>
                    </div>
                    <button onclick="planRoute()" class="w-full py-4 text-xl font-bold rounded-xl shadow-lg text-text-light bg-accent hover:bg-teal-400 transition duration-300 transform hover:scale-[1.02] active:scale-100 ring-2 ring-accent ring-offset-2 ring-offset-bg-card">
                        ğŸ“ é–‹å•Ÿ Google åœ°åœ–å°èˆª
                    </button>
                    <div id="route-message" class="mt-6 p-4 rounded-xl text-center text-lg font-medium hidden"></div>
                </div>
            `;
            appContent.insertAdjacentHTML('beforeend', content);
        }

        function planRoute() {
            const select = document.getElementById('destination-select');
            const message = document.getElementById('route-message');

            if (!select || !select.value) {
                 message.textContent = 'âŒ è«‹å…ˆé¸æ“‡ä¸€å€‹æœ‰æ•ˆåœ°é»ã€‚';
                 message.className = 'mt-6 p-4 rounded-xl text-center text-lg font-medium bg-red-900/50 text-red-200 border border-red-500 block';
                return;
            }

            const selectedText = select.options[select.selectedIndex].text;
            const destinationName = select.value;
            const encodedDestination = encodeURIComponent(destinationName);

            // ã€ä¿®å¾©ã€‘ä½¿ç”¨æ¨™æº– Google Maps å°èˆªé€£çµ
            const mapsUrl = `https://www.google.com/maps/dir/?api=1&destination=${encodedDestination}&travelmode=driving`;
            
            window.open(mapsUrl, '_blank');
            
            message.innerHTML = `âœ… å·²ç‚º <b>${selectedText}</b> é–‹å•Ÿ Google åœ°åœ–ï¼`;
            message.className = 'mt-6 p-4 rounded-xl text-center text-lg font-medium bg-green-900/50 text-green-200 border border-green-500 block';
        }

        function handleMessageSubmit(event) {
            event.preventDefault(); 
            const nameInput = document.getElementById('message-name').value || 'åŒ¿åè¨ªå®¢';
            const contentInput = document.getElementById('message-content').value;

            if (contentInput.trim() === '') {
                alert('âŒ ç•™è¨€å…§å®¹ä¸èƒ½ç‚ºç©ºï¼');
                return;
            }
            alert(`âœ… æ„Ÿè¬æ‚¨çš„ç•™è¨€ï¼Œ${nameInput}ï¼\næˆ‘å€‘å·²æ”¶åˆ°æ‚¨çš„å»ºè­°ã€‚`);
            document.getElementById('message-form').reset();
        }

        // åˆå§‹åŒ–
        renderLandingView();
    </script>
</body>
</html>