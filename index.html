
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨å°è¦½</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Serif TC', serif; }
        .transition-transform { transition: transform 0.3s ease; }
        #app-content.h-full { height: 100%; }

        /* 1. é¦–é èƒŒæ™¯åœ–æ¨£å¼ï¼šèƒŒæ™¯ä½ç½®è¨­ç‚ºåº•éƒ¨å„ªå…ˆ (bottom center) */
        .landing-bg {
            /* åœ–ç‰‡ä¾†æºä½¿ç”¨ä¸€å€‹ä½”ä½åœ–ï¼Œæ‚¨å¯ä»¥åœ¨æ­¤æ›¿æ›ç‚ºæ‚¨çš„å¯¦éš›èƒŒæ™¯åœ– */
            background-image: url('./landing-bg.jpg');
            background-size: cover;
            background-position: bottom center; /* è®“åœ–ç‰‡çš„åº•éƒ¨éƒ¨åˆ†è¢«å„ªå…ˆé¡¯ç¤º */
            background-attachment: fixed;
        }
        
        /* 2. åœ–ç‰‡å¡«æ»¿å®¹å™¨ä¸”è£åˆ‡ï¼šé ‚éƒ¨å„ªå…ˆ (é è¨­å€¼) */
        .img-cover-top {
            object-fit: cover; /* è®“åœ–ç‰‡å¡«æ»¿æ•´å€‹å®¹å™¨ï¼Œå¤šé¤˜éƒ¨åˆ†è£åˆ‡ */
            object-position: center top; /* ç¢ºä¿åœ–ç‰‡çš„é ‚éƒ¨åœ¨å®¹å™¨å…§å¯è¦‹ */
        }

        /* 3. åœ–ç‰‡å¡«æ»¿å®¹å™¨ä¸”è£åˆ‡ï¼šåº•éƒ¨å„ªå…ˆ (ç”¨æ–¼æµ·å±±æ¼æ¸¯) */
        .img-cover-bottom {
            object-fit: cover; 
            object-position: center bottom; /* ç¢ºä¿åœ–ç‰‡çš„åº•éƒ¨åœ¨å®¹å™¨å…§å¯è¦‹ */
        }
        
        /* 4. åœ–ç‰‡å¡«æ»¿å®¹å™¨ä¸”è£åˆ‡ï¼šä¸­å¿ƒå„ªå…ˆ (ç”¨æ–¼å®šç½®æ¼å ´) */
        .img-cover-center {
            object-fit: cover; 
            object-position: center center; /* ç¢ºä¿åœ–ç‰‡çš„ä¸­å¿ƒåœ¨å®¹å™¨å…§å¯è¦‹ */
        }

        /* åœ“åœˆåœ–ç¤ºæ¨£å¼ */
        .circle-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 2rem; 
            height: 2rem; 
            border-radius: 9999px; /* åœ“å½¢ */
            background-color: #06B6D4; /* accent color */
            color: #F8FAFC; /* text-light color */
            font-size: 1rem;
            font-weight: bold;
            flex-shrink: 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // é¡è‰²èª¿æ•´ç‚ºæ·±è—è‰²ç³»
                        'bg-main': '#0A192F', // ä¸»èƒŒæ™¯è‰²ï¼šæ·±è—è‰²
                        'bg-card': '#172A46', // å¡ç‰‡èƒŒæ™¯è‰²ï¼šè¼ƒæ·±çš„è—è‰² (ç”¨æ–¼å°èˆªã€ä¸»è¦å®¹å™¨)
                        'bg-mid-card': '#34496b', // ä¸­æ·±å¡ç‰‡è‰² (ç”¨æ–¼äº’å‹•å…ƒç´ ã€åˆ—è¡¨)
                        'text-light': '#F8FAFC', // æ–‡å­—è‰²ï¼šç™½è‰² (ä¸»è¦æ–‡å­—ï¼Œå…¨ç¶²ç«™æ–‡å­—é¡è‰²)
                        'secondary': '#94A3B8', // ä»ä¿ç•™ï¼Œä½†æœƒç›¡é‡ä½¿ç”¨ text-light
                        'primary': '#3B82F6', // ä»ä¿ç•™ï¼Œä½†æœƒç›¡é‡ä½¿ç”¨ text-light
                        'accent': '#06B6D4', // æ¬¡è¦å¼·èª¿è‰²ï¼šé’è‰² (ç”¨æ–¼æŒ‰éˆ•èƒŒæ™¯ã€é‚Šæ¡†)
                    }
                }
            }
        }
    </script>
</head>
<!-- åˆå§‹èƒŒæ™¯ç‚ºæ·±è—è‰² (bg-bg-main) -->
<body class="bg-bg-main text-text-light min-h-screen flex flex-col">

    <!-- å°èˆªåˆ— -->
    <nav class="sticky top-0 z-10 bg-bg-card shadow-xl border-b-2 border-accent/50">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- è¿”å›æŒ‰éˆ• -->
                <button id="back-btn" class="flex items-center text-text-light hover:text-accent transition duration-150 hidden" onclick="goBack()">
                    <svg class="h-6 w-6 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                    <span class="text-base font-medium hidden sm:inline">è¿”å›</span>
                </button>
                <div class="flex-shrink-0 flex-grow text-center sm:text-left">
                    <!-- å°èˆªæ¨™é¡Œ -->
                    <span id="nav-title" class="text-xl font-extrabold text-text-light transition duration-300">æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨å°è¦½</span>
                </div>
                <div class="w-12"></div>
            </div>
        </div>
    </nav>

    <!-- ä¸»å…§å®¹ -->
    <main class="flex-grow p-4 sm:p-8 max-w-4xl mx-auto w-full">
        <!-- ä¸»å…§å®¹å®¹å™¨ -->
        <div id="app-content" class="bg-bg-card p-6 sm:p-10 rounded-3xl shadow-2xl border border-gray-700 min-h-[60vh] transition-transform">
            <!-- å…§å®¹å‹•æ…‹ç”Ÿæˆ -->
        </div>
    </main>

    <!-- é è…³ -->
    <footer class="bg-bg-card/50 py-6 mt-auto border-t border-gray-700">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p class="text-text-light text-sm">&copy; 2025 æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨ã€‚</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Google Maps åµŒå…¥çš„æ¦‚ç•¥ä½ç½® URL (é¦™å±±åœ°å€ - åœ°æ–¹ç”¢æ¥­åœ°é»ä½¿ç”¨æ­¤çµ±ä¸€åœ°åœ–)
        const XIANGSHAN_MAP_URL = "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d116315.65775432021!2d120.91698650000001!3d24.84716155!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x34685e1b21239c4d%3A0x8683c3486c4f305!2z5paw5puy5rW35bGx6a-s56ef!5e0!3m2!1szh-TW!2stw!4v1701700000000!5m2!1szh-TW!2stw";

        // MUSEUM_DATAï¼šåœ°æ–¹ç”¢æ¥­ä¸»é¡Œä¸‹çš„å››å€‹åœ°é»éƒ½å·²æ–°å¢ map_url
        const MUSEUM_DATA = {
            "æµ·èˆ‡ç”Ÿæ´»": {
                "æµ·å±±æ¼æ¸¯": {
                    description: "æµ·å±±æ¼æ¸¯æ˜¯æ–°ç«¹è‘—åçš„æ¼æ¸¯ä¹‹ä¸€ï¼Œè¦‹è­‰äº†åœ¨åœ°æ¼æ¥­çš„è®Šé·èˆ‡ç™¼å±•ï¼Œæ›´æ˜¯è§€å¯Ÿå¤•é™½èˆ‡æµ·æ™¯çš„çµ•ä½³åœ°é»ã€‚",
                    timing: "ğŸŒ… æœ€ä½³æ™‚é–“ï¼šæ—¥è½æ™‚åˆ† (å»ºè­°æŸ¥è©¢ç•¶æ—¥å¤•é™½æ™‚é–“) æ™¯è‰²æœ€ç¾ã€‚æ½®æ±æ™‚é–“ä¸å›ºå®šï¼Œå»ºè­°æŸ¥è©¢ç•¶æ—¥ä¹¾æ½®å‰å¾Œä¸€å°æ™‚å‰å¾€ã€‚",
                    map_url: XIANGSHAN_MAP_URL // ã€æ–°å¢ã€‘åœ°åœ–é€£çµ
                },
                "å®šç½®æ¼å ´": {
                    description: "å®šç½®æ¼å ´æ˜¯ä¸€ç¨®æ°¸çºŒçš„æ¼æ’ˆæ–¹å¼ï¼Œåˆ©ç”¨åœ°åˆ©èˆ‡æ½®æµæ•æ‰æ´„æ¸¸é­šé¡ï¼Œå±•ç¾äº†äººèˆ‡æµ·å…±å­˜çš„æ™ºæ…§ã€‚",
                    timing: "ğŸŸ æ¼ç²è²©è³£ï¼šæ¯å¤©ä¸‹åˆ 2 é»å·¦å³æ˜¯æ¼ç²è²©è³£æ™‚é–“ï¼Œå¯è¿‘è·é›¢è§€å¯Ÿæ¼ç²æ‹è³£ã€‚",
                    map_url: XIANGSHAN_MAP_URL // ã€æ–°å¢ã€‘åœ°åœ–é€£çµ
                },
                "é¦™å±±æ¿•åœ°": {
                    description: "é¦™å±±æ¿•åœ°æ˜¯é‡è¦çš„ç”Ÿæ…‹ä¿è­·å€ï¼Œæ“æœ‰è±å¯Œçš„åº•æ£²ç”Ÿç‰©èˆ‡æ°´é³¥è³‡æºï¼Œæ˜¯è‡ªç„¶æ•™è‚²çš„æœ€ä½³å ´åŸŸã€‚",
                    timing: "ğŸ¦¢ è§€å¯Ÿç”Ÿæ…‹ï¼šå»ºè­°åœ¨é€€æ½®å‰å¾Œ 2 å°æ™‚å‰å¾€ï¼Œå®¹æ˜“è§€å¯Ÿåˆ°æ‹›æ½®èŸ¹èˆ‡å½ˆå¡—é­šã€‚æ¯å¹´ 9 æœˆè‡³éš”å¹´ 5 æœˆæ˜¯è³é³¥å­£ã€‚",
                    map_url: XIANGSHAN_MAP_URL // ã€æ–°å¢ã€‘åœ°åœ–é€£çµ
                }
            },
            "ä¿¡ä»°èˆ‡æ–‡åŒ–": {
                "æ°´è“®å®®": {
                    description: "æ°´è“®å®®æ˜¯ç•¶åœ°é‡è¦çš„ä¿¡ä»°ä¸­å¿ƒï¼Œä¾›å¥‰åª½ç¥–ï¼Œå®ˆè­·è‘—è¨æµ·äººçš„å¹³å®‰ã€‚",
                    timing: "ğŸ™ åƒæ‹œæ™‚é–“ï¼šç™½å¤©æ™‚æ®µå‰å¾€ï¼Œé¿é–‹ä¸­åˆçƒˆæ—¥ã€‚",
                    map_url: XIANGSHAN_MAP_URL // ã€æ–°å¢ã€‘åœ°åœ–é€£çµ
                },
                "é¦™å±±å¤©åå®®": {
                    description: "æ­·å²æ‚ ä¹…çš„é¦™å±±å¤©åå®®ï¼Œå…¶å»ºç¯‰å·¥è—èˆ‡æ­·å²åƒ¹å€¼ä»£è¡¨è‘—å®¢å®¶èˆ‡ç¦ä½¬æ–‡åŒ–èåˆçš„è»Œè·¡ã€‚",
                    timing: "ğŸ™ åƒæ‹œæ™‚é–“ï¼šç™½å¤©æ™‚æ®µå‰å¾€ï¼Œé¿é–‹ä¸­åˆçƒˆæ—¥ã€‚",
                    map_url: XIANGSHAN_MAP_URL // ã€æ–°å¢ã€‘åœ°åœ–é€£çµ
                }
            },
            "åœ°æ–¹ç”¢æ¥­": {
                // å·²æœ‰ map_urlï¼Œå°‡æœƒé¡¯ç¤ºåœ°åœ–
                "èŒ¶èŠ±åœ’": {
                    description: "æ–°ç«¹çš„æ°£å€™é©åˆèŒ¶èŠ±ç”Ÿé•·ï¼ŒèŒ¶èŠ±åœ’ä¸åƒ…æ˜¯è§€å…‰æ™¯é»ï¼Œæ›´æ˜¯é‡è¦çš„èŠ±å‰ç”¢æ¥­åŸºåœ°ã€‚",
                    timing: "ğŸŒ¸ æœ€ä½³èŠ±æœŸï¼šæ¯å¹´ 11 æœˆè‡³éš”å¹´ 3 æœˆæ˜¯æœ€ä½³è§€è³æ™‚é–“ã€‚",
                    map_url: XIANGSHAN_MAP_URL 
                },
                // å·²æœ‰ map_urlï¼Œå°‡æœƒé¡¯ç¤ºåœ°åœ–
                "å’–å•¡è±†": {
                    description: "æµ·å±±ç¤¾å€è‡ªå®¶çƒ˜ç„™çš„å’–å•¡è±†ï¼Œæ˜¯ç”±ç¤¾å€çš„ã€Œè€è‡˜è‚‰ã€å€‘è¦ªæ‰‹æ²–æ³¡çš„åœ¨åœ°é¢¨å‘³ã€‚è±†å­å¸¶æœ‰ç¨ç‰¹ã€æº«å’Œçš„å¯å¯é¦™æ°£ï¼Œå‘³é“æ¨¸å¯¦å»æº«æš–ï¼Œå°±åƒæµ·å±±äººçš„å€‹æ€§ä¸€æ¨£ã€‚æ¯ä¸€æ¯å’–å•¡ï¼Œä¸åªæ˜¯é£²å“ï¼Œæ›´æ‰¿è¼‰è‘—å±…æ°‘çš„æ‰‹è—ã€æ­²æœˆå’Œç”Ÿæ´»æ•…äº‹ï¼Œè®“äººå–ä¸‹å»å°±èƒ½æ„Ÿå—åˆ°æµ·å±±çš„æ—¥å¸¸æº«åº¦ã€‚",
                    timing: "â˜• è³¼è²·æ™‚é–“ï¼šè«‹ä¾æµ·å±±ç¤¾å€ç™¼å±•å”æœƒç‡Ÿæ¥­æ™‚é–“å‰å¾€ã€‚",
                    map_url: XIANGSHAN_MAP_URL 
                },
                // å·²æœ‰ map_urlï¼Œå°‡æœƒé¡¯ç¤ºåœ°åœ–
                "å®šç½®æ¼å ´": {
                    description: "ï¼ˆå†æ¬¡æåŠï¼‰å®šç½®æ¼å ´é™¤äº†æ˜¯æ¼æ’ˆæ–¹å¼ï¼Œä¹Ÿæ˜¯åœ°æ–¹ç¶“æ¿Ÿç”¢æ¥­çš„ä¸€ç’°ã€‚",
                    timing: "ğŸŸ æ¼ç²è²©è³£ï¼šæ¯å¤©ä¸‹åˆ 2 é»å·¦å³æ˜¯æ¼ç²è²©è³£æ™‚é–“ï¼Œå¯è¿‘è·é›¢è§€å¯Ÿæ¼ç²æ‹è³£ã€‚",
                    map_url: XIANGSHAN_MAP_URL 
                },
                // å·²æœ‰ map_urlï¼Œå°‡æœƒé¡¯ç¤ºåœ°åœ–
                "é€²å£«ç‰§å ´": {
                    description: "é€²å£«ç‰§å ´æ˜¯çŸ¥åçš„ä¹³ç‰›ç‰§å ´ï¼Œæä¾›æ–°é®®ä¹³è£½å“ã€‚",
                    timing: "ğŸ¥› ç‡Ÿæ¥­æ™‚é–“ï¼šè«‹æŸ¥è©¢ç‰§å ´å®˜æ–¹å…¬å‘Šã€‚",
                    map_url: XIANGSHAN_MAP_URL 
                }
            },
            "å¤šæ—ç¾¤å…±æ§‹": {
                "é‚£é­¯ç£": {
                    description: "ã€Œé‚£é­¯ç£ã€ä»£è¡¨è‘—å¤šæ—ç¾¤èåˆçš„ç²¾ç¥ï¼Œæ˜¯ç¤¾å€æ´»å‹•èˆ‡äº¤æµçš„ä¸­å¿ƒã€‚",
                    timing: "ğŸ¤ æ´»å‹•æ™‚é–“ï¼šè«‹æŸ¥è©¢åœ¨åœ°ç¤¾å€å…¬å‘Šã€‚",
                    map_url: XIANGSHAN_MAP_URL // ã€æ–°å¢ã€‘åœ°åœ–é€£çµ
                },
                "ç™¼å±•å”æœƒä¸­å¿ƒ": {
                    description: "åœ°æ–¹ç™¼å±•å”æœƒä¸­å¿ƒæ˜¯æ¨å‹•ç¤¾å€ç‡Ÿé€ å’Œæ–‡åŒ–å‚³æ‰¿çš„æ ¸å¿ƒçµ„ç¹”ã€‚",
                    timing: "â° å»ºè­°æ™‚é–“ï¼šè«‹æ–¼é€±é–“ä¸Šç­æ™‚é–“æˆ–æ´»å‹•æ—¥å‰å¾€ï¼Œç¢ºèªæœå‹™æœå‹™æ™‚é–“ã€‚",
                    map_url: XIANGSHAN_MAP_URL // ã€æ–°å¢ã€‘åœ°åœ–é€£çµ
                }
            }
        };

        const ROUTE_LOCATIONS = ["æµ·å±±æ¼æ¸¯", "å®šç½®æ¼å ´", "é¦™å±±æ¿•åœ°"];


        const CATEGORY_ICONS = {
            "æµ·èˆ‡ç”Ÿæ´»": `<svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8v8A4 4 4 0 0 1 8 16V8a4 4 4 0 0 1 8 0z"/><path d="M12 21V3"/><path d="M17 17l4 4"/><path d="M7 17l-4 4"/></svg>`,
            "ä¿¡ä»°èˆ‡æ–‡åŒ–": `<svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3a6 6 0 0 0 9 7.42V20a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V10.42A6 6 0 0 0 12 3Z"/><path d="M9 22V8.5c0-.9.4-1.5 1-1.5c.6 0 1 .4 1 1v4m-1 0h2m-1 0v-4c0-.6.4-1 1-1h2c.6 0 1 .4 1 1v4"/></svg>`,
            "åœ°æ–¹ç”¢æ¥­": `<svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 10v4c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2v-4"/><path d="M12 16v6"/><path d="M12 2v4"/><path d="M17 6h3a2 2 0 0 1 2 2v2"/><path d="M7 6H4a2 2 0 0 0-2 2v2"/><path d="M22 14v2a2 2 0 0 1-2 2h-3"/><path d="M2 14v2a2 2 0 0 0 2 2h3"/></svg>`,
            "å¤šæ—ç¾¤å…±æ§‹": `<svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>`
        };

        const appContent = document.getElementById('app-content');
        const navTitle = document.getElementById('nav-title');
        const backBtn = document.getElementById('back-btn');
        let historyStack = [];
        let currentView = { id: 'landing', data: null };

        function navigateTo(viewId, data = null) {
            // è™•ç†é¦–é èƒŒæ™¯åœ–çš„åˆ‡æ›
            if (viewId === 'landing') {
                document.body.classList.add('landing-bg', 'bg-transparent');
                document.body.classList.remove('bg-bg-main');
            } else {
                document.body.classList.remove('landing-bg', 'bg-transparent');
                document.body.classList.add('bg-bg-main');
            }


            if (currentView.id !== viewId && viewId !== 'landing') {
                historyStack.push({ view: currentView.id, data: currentView.data });
            }
            appContent.classList.remove('flex', 'items-center', 'justify-center', 'h-full');
            appContent.innerHTML = '';
            currentView.id = viewId;
            currentView.data = data;

            switch (viewId) {
                case 'landing': renderLandingView(); break;
                case 'home': renderHomeView(); break;
                case 'category': renderCategoryView(data); break;
                case 'detail': renderDetailView(data); break;
                case 'routePlanningEntry': renderRoutePlanningEntry(data); break; // æ–°å¢çš„è·¯ç·šè¦åŠƒå…¥å£
                default: renderLandingView();
            }
            updateNavigation(viewId, data);
        }

        function goBack() {
            if (historyStack.length > 0) {
                const previousState = historyStack.pop();
                currentView.id = previousState.view;
                currentView.data = previousState.data;
                appContent.classList.remove('flex', 'items-center', 'justify-center', 'h-full');
                appContent.innerHTML = '';
                
                // è™•ç†é¦–é èƒŒæ™¯åœ–çš„åˆ‡æ› (è¿”å›æ™‚)
                if (currentView.id === 'landing') {
                    document.body.classList.add('landing-bg', 'bg-transparent');
                    document.body.classList.remove('bg-bg-main');
                } else {
                    document.body.classList.remove('landing-bg', 'bg-transparent');
                    document.body.classList.add('bg-bg-main');
                }

                switch (currentView.id) {
                    case 'landing': renderLandingView(); break;
                    case 'home': renderHomeView(); break;
                    case 'category': renderCategoryView(currentView.data); break;
                    case 'detail': renderDetailView(currentView.data); break;
                    case 'routePlanningEntry': renderRoutePlanningEntry(currentView.data); break;
                    default: renderLandingView();
                }
                updateNavigation(currentView.id, currentView.data);
            }
        }

        function updateNavigation(viewId, data) {
            // å°èˆªåˆ—æ–‡å­—çµ±ä¸€ä½¿ç”¨ text-text-light (ç™½è‰²)
            if (viewId === 'landing') {
                navTitle.textContent = "æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨";
                backBtn.classList.add('hidden');
                historyStack = [];
            } else if (viewId === 'home') {
                navTitle.textContent = "æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨ï¼å¾é¦™å±±è»Šç«™å‡ºç™¼";
                backBtn.classList.add('hidden'); 
            } else if (viewId === 'category') {
                navTitle.textContent = data.categoryName; // åªéœ€è¦é¡¯ç¤ºä¸»é¡Œåç¨±
                backBtn.classList.remove('hidden');
            } else if (viewId === 'detail') {
                navTitle.textContent = data.locationName;
                backBtn.classList.remove('hidden');
            } else if (viewId === 'routePlanningEntry') {
                navTitle.textContent = `${data.categoryName} - è·¯ç·šè¦åŠƒ`;
                backBtn.classList.remove('hidden');
            }
        }

        function renderLandingView() {
            appContent.classList.add('flex', 'items-center', 'justify-center', 'h-full');
            // ç‚ºé¦–é å…§å®¹æ·»åŠ åŠé€æ˜èƒŒæ™¯ï¼Œç¢ºä¿åœ¨èƒŒæ™¯åœ–ä¸Šæ–‡å­—æ¸…æ™°
            const content = `
                <header class="text-center p-8 rounded-2xl bg-bg-card/90 backdrop-blur-sm shadow-2xl">
                    <!-- ä¸»æ¨™é¡Œæ”¹ç‚ºç´”ç™½è‰² text-text-light -->
                    <h1 class="text-5xl sm:text-6xl font-extrabold text-text-light mb-6">æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨</h1>
                    <!-- å‰¯æ¨™é¡Œæ”¹ç‚ºç´”ç™½è‰² text-text-light -->
                    <p class="text-xl text-text-light mb-12">æ¢ç´¢é¦™å±±åœ°å€è±å¯Œçš„ç”Ÿæ…‹ã€æ­·å²èˆ‡äººæ–‡è„ˆçµ¡ã€‚</p>
                    <!-- æŒ‰éˆ•æ–‡å­—æ”¹ç‚º text-text-lightï¼ŒèƒŒæ™¯æ”¹ç‚º bg-accentï¼Œé‚Šæ¡†ç’°ç¹æ”¹ç‚º ring-accent -->
                    <button onclick="navigateTo('home')" class="inline-flex items-center py-4 px-10 text-xl font-bold rounded-full shadow-2xl text-text-light bg-accent hover:bg-teal-400 transition duration-300 transform hover:scale-[1.05] active:scale-100 ring-4 ring-accent/50 ring-offset-bg-card ring-offset-2">
                        å¾é¦™å±±è»Šç«™å‡ºç™¼
                        <svg class="h-6 w-6 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                    </button>
                </header>
            `;
            appContent.insertAdjacentHTML('beforeend', content);
        }
        
        function renderHomeView() {
            const header = `
                <header class="text-center mb-12">
                    <!-- ä¸»æ¨™é¡Œå·²æ˜¯ text-text-light -->
                    <h1 class="text-4xl sm:text-5xl font-extrabold text-text-light mb-2">é¸æ“‡æƒ³è¦çš„ä¸»é¡Œ</h1>
                    <!-- å‰¯æ¨™é¡Œå·²æ˜¯ text-text-light -->
                    <p class="text-lg text-text-light">é»æ“Šä¸»é¡Œå¡ç‰‡ï¼Œæ·±å…¥æ¢ç´¢æµ·å±±ç”Ÿæ…‹åšç‰©é¤¨çš„æ ¸å¿ƒåƒ¹å€¼ã€‚</p>
                </header>
            `;
            appContent.insertAdjacentHTML('beforeend', header);

            const categories = Object.keys(MUSEUM_DATA);
            const categorySection = document.createElement('div');
            categorySection.className = 'grid grid-cols-1 md:grid-cols-2 gap-8 mb-16';

            categories.forEach(category => {
                const icon = CATEGORY_ICONS[category] || '';
                const button = document.createElement('button');
                // å¡ç‰‡èƒŒæ™¯ç‚ºä¸­æ·±è‰² (bg-bg-mid-card)ï¼Œæ–‡å­—åŸºåº•ç‚ºç™½è‰² (text-text-light)
                button.className = 'flex flex-col items-center justify-center p-8 text-center rounded-2xl shadow-xl border-t-8 border-accent bg-bg-mid-card text-text-light hover:bg-bg-mid-card/80 transition duration-300 transform hover:scale-[1.03] active:scale-100';
                
                // åœ–ç¤ºå’Œæè¿°æ–‡å­—éƒ½ä½¿ç”¨ text-text-light (ç´”ç™½è‰²)
                button.innerHTML = `
                    <div class="text-text-light mb-3">${icon}</div>
                    <span class="text-2xl font-bold">${category}</span>
                    <p class="text-base text-text-light mt-1">é»æ“Šé€²å…¥ ${category} ä¸»é¡Œ</p>
                `;
                
                button.onclick = () => {
                    // æ‰€æœ‰ä¸»é¡Œéƒ½ç›´æ¥å°å‘åœ°é»åˆ—è¡¨ (renderCategoryView)
                    navigateTo('category', { categoryName: category });
                };
                categorySection.appendChild(button);
            });
            appContent.appendChild(categorySection);

            // è²¼ä¸Šé€™æ®µç¨‹å¼ç¢¼ï¼Œæ–°å¢ç•™è¨€å€
const messageBoardSection = `
    <section class="p-8 bg-bg-mid-card/50 rounded-2xl text-text-light shadow-2xl border border-accent/30">
        <h2 class="text-3xl font-bold mb-6 text-center border-b border-accent/50 pb-3">ğŸ’¬ ç•™è¨€æ¿èˆ‡å»ºè­°å€</h2>
        
        <form id="message-form" onsubmit="handleMessageSubmit(event)" class="space-y-4">
            <div>
                <label for="message-name" class="block text-lg font-medium text-text-light mb-2">æ‚¨çš„åç¨± (é¸å¡«):</label>
                <input type="text" id="message-name" placeholder="åŒ¿åè¨ªå®¢" 
                       class="w-full p-3 rounded-lg border border-gray-600 bg-bg-card text-text-light placeholder-gray-500 focus:ring-accent focus:border-accent" />
            </div>

            <div>
                <label for="message-content" class="block text-lg font-medium text-text-light mb-2">æ‚¨çš„ç•™è¨€/å»ºè­°:</label>
                <textarea id="message-content" rows="4" required placeholder="è«‹åˆ†äº«æ‚¨çš„åƒè§€å¿ƒå¾—æˆ–å»ºè­°..." 
                          class="w-full p-3 rounded-lg border border-gray-600 bg-bg-card text-text-light placeholder-gray-500 focus:ring-accent focus:border-accent"></textarea>
            </div>

            <button type="submit" 
                    class="w-full flex items-center justify-center py-3 px-6 text-lg font-bold rounded-xl shadow-lg text-text-light bg-accent hover:bg-teal-400 transition duration-300 transform hover:scale-[1.01] active:scale-100 ring-2 ring-offset-2 ring-accent/50 ring-offset-bg-card">
                <svg class="h-6 w-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.669A8.006 8.006 0 013 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg>
                é€å‡ºç•™è¨€
            </button>
        </form>
    </section>
`;
appContent.insertAdjacentHTML('beforeend', messageBoardSection);
        }

        // Map View - åµŒå…¥ Google Maps Iframe
        function renderMapView(data) {
            // é€™å€‹è¦–åœ–ä¸å†ä½¿ç”¨ï¼Œä½†é‚è¼¯ä¿ç•™ä»¥é˜²å…¶ä»–æŒ‰éˆ•èª¤è§¸
            const { categoryName } = data;
            const content = `
                <header class="mb-8 border-b-2 border-accent/50 pb-4">
                    <h1 class="text-4xl font-extrabold text-text-light mb-2">åœ°åœ–</h1>
                    <p class="text-lg text-text-light font-medium">ä¸»é¡Œï¼š${categoryName}</p>
                </header>
                <div class="text-lg leading-relaxed text-text-light space-y-6">
                    <iframe src="${XIANGSHAN_MAP_URL}" 
                            width="100%" height="384" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade" 
                            class="rounded-xl shadow-2xl border-4 border-accent/50"></iframe>
                    <p class="p-4 bg-accent/10 border-l-4 border-accent rounded-xl italic text-base shadow-sm text-text-light">æ­¤è™•é¡¯ç¤ºçš„æ˜¯æ–°ç«¹å¸‚é¦™å±±å€çš„æ¦‚ç•¥åœ°åœ–ï¼Œæ‚¨å¯ä»¥æ”¾å¤§ç¸®å°æˆ–é»æ“Šã€ŒæŸ¥çœ‹å¤§åœ–ã€é€²è¡Œäº’å‹•ã€‚</p>
                </div>`;
            appContent.insertAdjacentHTML('beforeend', content);
        }

        // Route View - è·¯ç·šæŒ‰éˆ•è¼”åŠ©å‡½å¼
        function renderRouteButton(label, emoji) {
            return `
                <button onclick="displayRouteDetails(event, '${label}')" class="flex flex-col items-center p-3 sm:p-5 rounded-xl text-center bg-accent/20 hover:bg-accent/40 text-text-light transition duration-200 transform hover:scale-105 shadow-md">
                    <span class="text-3xl sm:text-4xl">${emoji}</span>
                    <span class="text-sm sm:text-lg font-bold mt-1">${label}</span>
                </button>
            `;
        }

        // é¡¯ç¤ºè·¯ç·šè©³æƒ…å‡½å¼
        function displayRouteDetails(event, type) {
            const resultDiv = document.getElementById('route-result');
            let details = '';
            
            // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„ active æ¨£å¼
            document.querySelectorAll('.grid-cols-3 button').forEach(btn => {
                btn.classList.remove('bg-accent', 'text-text-light', 'bg-accent/70');
                btn.classList.add('bg-accent/20', 'text-text-light');
            });

            // ç‚ºè¢«é»æ“Šçš„æŒ‰éˆ•æ·»åŠ  active æ¨£å¼
            const clickedButton = event.currentTarget;
            if (clickedButton) {
                clickedButton.classList.add('bg-accent', 'bg-accent/70', 'text-text-light');
                clickedButton.classList.remove('bg-accent/20');
            }


            switch(type) {
                case 'æ­¥è¡Œ':
                    details = `<div class="p-4">
                               <p class="text-2xl font-bold mb-2 text-text-light">ğŸš¶ æ­¥è¡Œè·¯ç·šå»ºè­°</p>
                               <p class="text-text-light">å»ºè­°è·¯ç·šé•·åº¦ç´„ 5 å…¬é‡Œï¼Œéœ€æ™‚ç´„ 1.5 - 2 å°æ™‚ã€‚ä¸»è¦ä¸²è¯é¦™å±±è»Šç«™ã€æ°´è“®å®®ã€æµ·å±±æ¼æ¸¯åŠé¦™å±±æ¿•åœ°æ­¥é“ã€‚é©åˆå–œæ­¡æ·±åº¦æ¼«éŠçš„éŠå®¢ã€‚</p>
                               <p class="mt-2 text-sm text-text-light/80">é©åˆæ™‚é–“ï¼šæ—©ä¸Šæˆ–å‚æ™šï¼Œé¿é–‹ä¸­åˆçƒˆæ—¥ã€‚</p>
                               </div>`;
                    break;
                case 'è…³è¸è»Š':
                    details = `<div class="p-4">
                               <p class="text-2xl font-bold mb-2 text-text-light">ğŸš² è…³è¸è»Šè·¯ç·šå»ºè­°</p>
                               <p class="text-text-light">å»ºè­°è·¯ç·šé•·åº¦ç´„ 12 å…¬é‡Œï¼Œéœ€æ™‚ç´„ 1 å°æ™‚ã€‚å¯æ²¿è‘—æµ·å²¸è‡ªè¡Œè»Šé“ï¼Œä¸²è¯æ¼æ¸¯ã€æ¿•åœ°èˆ‡éƒ¨åˆ†ç”¢æ¥­é»ã€‚è·¯æ³å¹³å¦ï¼Œæ©Ÿå‹•æ€§é«˜ã€‚</p>
                               <p class="mt-2 text-sm text-text-light/80">è«‹æ³¨æ„ï¼šéƒ¨åˆ†æ¿•åœ°æ­¥é“ç¦æ­¢è‡ªè¡Œè»Šé€²å…¥ã€‚</p>
                               </div>`;
                    break;
                case 'å°ˆäººè§£èªª':
                    details = `<div class="p-4">
                               <p class="text-2xl font-bold mb-2 text-text-light">ğŸ‘¨â€ğŸ« å°ˆäººè§£èªªæœå‹™</p>
                               <p class="text-text-light">è«‹æ´½è©¢åœ¨åœ°ã€Œç™¼å±•å”æœƒä¸­å¿ƒã€é ç´„å°ˆäººå°è¦½æœå‹™ (ç´„ 3 å°æ™‚è¡Œç¨‹)ã€‚å°è¦½å“¡å°‡å¸¶é ˜æ‚¨æ·±å…¥äº†è§£åœ¨åœ°æ­·å²èˆ‡ç”Ÿæ…‹æ•…äº‹ã€‚</p>
                               <p class="mt-2 text-sm text-text-light/80">éœ€æå‰é ç´„ï¼Œæ”¶è²»è«‹ä¾å”æœƒå…¬å‘Šç‚ºä¸»ã€‚</p>
                               </div>`;
                    break;
                default:
                    details = `<p class="text-text-light">é»æ“Šä¸Šæ–¹é¸é …ï¼ŒæŸ¥çœ‹å»ºè­°çš„è·¯ç·šè³‡è¨Šã€‚</p>`;
            }

            resultDiv.innerHTML = details;
        }

        // Route View - å¢åŠ ä¸‰å€‹äº¤é€šæ–¹å¼æŒ‰éˆ•å’Œçµæœå€
        function renderRouteView(data) {
            const { categoryName } = data; 
            
            const locationBadges = ROUTE_LOCATIONS.map((location) => {
                return `
                    <div class="flex items-center space-x-2 text-lg font-semibold">
                        <span class="text-text-light border-b border-accent/50 pb-1">${location}</span>
                    </div>
                `;
            }).join(`
                <span class="text-accent text-xl font-bold flex-shrink-0 mx-2">|</span>
            `);

            const content = `
                <header class="mb-8 border-b-2 border-accent/50 pb-4">
                    <h1 class="text-4xl font-extrabold text-text-light mb-2">è·¯ç·šè¦åŠƒ</h1>
                    <p class="text-lg text-text-light font-medium">ä¸»é¡Œï¼š${categoryName} | è«‹é¸æ“‡æ‚¨çš„äº¤é€šæ–¹å¼ã€‚</p>
                </header>
                
                <section class="mb-10 p-5 rounded-xl bg-bg-mid-card/50 shadow-xl border border-gray-700">
                    <h2 class="text-xl font-bold text-text-light mb-4">ğŸ“ è·¯ç·šç¶“éåœ°é»ï¼š</h2>
                    <div class="flex flex-wrap items-center justify-start space-x-3 space-y-2">
                        ${locationBadges}
                    </div>
                </section>

                <div class="grid grid-cols-3 gap-4 mb-8">
                    ${renderRouteButton('æ­¥è¡Œ', 'ğŸš¶')}
                    ${renderRouteButton('è…³è¸è»Š', 'ğŸš²')}
                    ${renderRouteButton('å°ˆäººè§£èªª', 'ğŸ‘¨â€ğŸ«')}
                </div>

                <div id="route-result" class="p-6 bg-bg-mid-card rounded-xl text-text-light min-h-[150px] shadow-inner flex items-center justify-center">
                    <p class="text-text-light">é»æ“Šä¸Šæ–¹é¸é …ï¼ŒæŸ¥çœ‹å»ºè­°çš„è·¯ç·šè³‡è¨Šã€‚</p>
                </div>
            `;
            appContent.insertAdjacentHTML('beforeend', content);
        }

        // ã€Category View - åœ°é»åˆ—è¡¨ã€‘
        function renderCategoryView(data) {
            const { categoryName } = data;
            const locations = MUSEUM_DATA[categoryName] || {};
            const title = categoryName;
            const subtitle = 'è«‹é¸æ“‡æ‚¨æƒ³æ·±å…¥äº†è§£çš„åœ°é»ã€‚';
            
            const header = `<header class="mb-10"><h1 class="text-3xl font-extrabold text-text-light mb-2">${title}</h1><p class="text-lg text-text-light">${subtitle}</p></header>`;
            appContent.insertAdjacentHTML('beforeend', header);

            const listContainer = document.createElement('div');
            listContainer.className = 'space-y-4';

            Object.keys(locations).forEach(locationName => {
                const button = document.createElement('button');
                button.className = 'flex items-center justify-between w-full p-5 text-left text-xl font-semibold rounded-xl shadow-md border border-gray-700 bg-bg-mid-card text-text-light hover:bg-bg-mid-card/80 hover:border-accent transition duration-200 transform hover:translate-x-1';
                button.innerHTML = `<span>${locationName}</span><svg class="h-6 w-6 ml-2 text-text-light" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>`;
                
                button.onclick = () => navigateTo('detail', { categoryName, locationName, detailsObject: locations[locationName] });
                listContainer.appendChild(button);
            });
            appContent.appendChild(listContainer);
            
            // ã€æ–°å¢é‚è¼¯ã€‘å¦‚æœé¡åˆ¥æ˜¯ã€Œåœ°æ–¹ç”¢æ¥­ã€ï¼Œå‰‡åœ¨åˆ—è¡¨æœ€ä¸‹é¢åŠ å…¥è·¯ç·šè¦åŠƒæŒ‰éˆ•
            if (categoryName === 'åœ°æ–¹ç”¢æ¥­' || categoryName === 'æµ·èˆ‡ç”Ÿæ´»' || categoryName === 'ä¿¡ä»°èˆ‡æ–‡åŒ–' || categoryName === 'å¤šæ—ç¾¤å…±æ§‹') { // é‡å°æ‰€æœ‰ä¸»é¡Œéƒ½é¡¯ç¤º
                const routeButtonHtml = `
                    <div class="pt-6">
                        <button onclick="navigateTo('routePlanningEntry', { categoryName: categoryName, locations: Object.keys(MUSEUM_DATA[categoryName]) })"
                                class="flex items-center justify-center w-full p-4 text-xl font-bold rounded-xl shadow-2xl text-text-light bg-accent hover:bg-teal-400 transition duration-300 transform hover:scale-[1.01] active:scale-100 ring-4 ring-accent/50 ring-offset-bg-card ring-offset-2">
                            <svg class="h-6 w-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l3-3m0 0l3 3m-3-3v-5m0 0v-5m0 5h5m-5 0h-5m5 0a9 9 0 110-18 9 9 0 010 18z"></path></svg>
                            è¦åŠƒ ${categoryName} è·¯ç·š
                        </button>
                        <p class="text-sm text-center text-gray-400 mt-2">é»æ“Šé€²å…¥è·¯ç·šè¦åŠƒå…¥å£ï¼Œé¸æ“‡ç›®çš„åœ°ã€‚</p>
                    </div>
                `;
                appContent.insertAdjacentHTML('beforeend', routeButtonHtml);
            }
        }

        // ã€Detail View - åœ°é»è©³ç´°ä»‹ç´¹ã€‘
        function renderDetailView(data) {
            // å¾ data ä¸­å–å‡º detailsObjectï¼Œè©²ç‰©ä»¶åŒ…å« description, timing å’Œ map_url
            const { locationName, detailsObject } = data;
            const detail = detailsObject.description;
            const timing = detailsObject.timing;
            const mapUrl = detailsObject.map_url; // å˜—è©¦å–å¾—åœ°åœ– URL

            let imageHtml = '';
            let imageUrl = '';
            let hasLocalImage = false;
            let imageClass = 'img-cover-top'; // é è¨­ç‚ºé ‚éƒ¨å„ªå…ˆ

            // è¨­å®šåœ–ç‰‡è·¯å¾‘
            const imageBase = ''; // å‡è¨­åœ–ç‰‡èˆ‡ index.html æª”æ¡ˆåœ¨åŒä¸€å±¤

            if (locationName === 'æµ·å±±æ¼æ¸¯') {
                imageUrl = imageBase + 'IMG_8277.jpg'; // å‡è¨­åœ¨æ ¹ç›®éŒ„
                hasLocalImage = true;
                imageClass = 'img-cover-bottom'; 
            } else if (locationName === 'å®šç½®æ¼å ´' && data.categoryName === 'æµ·èˆ‡ç”Ÿæ´»') {
                imageUrl = imageBase + 'IMG_0030.jpg'; // å‡è¨­åœ¨æ ¹ç›®éŒ„
                hasLocalImage = true;
                imageClass = 'img-cover-center'; 
            } else if (locationName === 'é¦™å±±æ¿•åœ°') {
                // é¦™å±±æ¿•åœ°ä»ä½¿ç”¨ä½”ä½åœ–ä½œç‚ºç¤ºä¾‹
                imageUrl = 'https://placehold.co/800x400/eab308/ffffff?text=é¦™å±±æ¿•åœ°+ç”Ÿæ…‹';
                hasLocalImage = true;
                imageClass = 'img-cover-center';
            }
            
            // 2. è¨­ç½®åœ°æ–¹ç”¢æ¥­çš„åœ–ç‰‡é‚è¼¯ (ä½¿ç”¨ä¿®æ­£å¾Œçš„ç¨ç«‹è·¯å¾‘)
            if (data.categoryName === 'åœ°æ–¹ç”¢æ¥­') {
                if (locationName === 'èŒ¶èŠ±åœ’') {
                    imageUrl = imageBase + 'store_teaflower.jpg';
                    hasLocalImage = true;
                    imageClass = 'img-cover-bottom'; 
                } else if (locationName === 'å’–å•¡è±†') {
                    imageUrl = imageBase + 'store_coffee.jpg';
                    hasLocalImage = true;
                    imageClass = 'img-cover-bottom';
                } else if (locationName === 'é€²å£«ç‰§å ´') {
                    imageUrl = imageBase + 'store_jinshi.jpg';
                    hasLocalImage = true;
                    imageClass = 'img-cover-center';
                }
                else if (locationName === 'å®šç½®æ¼å ´') {
                    imageUrl = imageBase + 'IMG_0030.jpg'; // æ²¿ç”¨æµ·èˆ‡ç”Ÿæ´»ä¸­çš„æª”æ¡ˆ
                    hasLocalImage = true;
                    imageClass = 'img-cover-center';
                }
            }


            if (hasLocalImage) {
                // åœ–ç‰‡å¡«æ»¿å®¹å™¨ä¸”è£åˆ‡ï¼Œä½¿ç”¨å‹•æ…‹ class æ±ºå®šå„ªå…ˆé¡¯ç¤ºéƒ¨åˆ†
                imageHtml = `
                    <div class="h-72 rounded-xl overflow-hidden shadow-lg border border-gray-700 bg-gray-900 flex items-center justify-center">
                        <img src="${imageUrl}" alt="${locationName} ç›¸é—œåœ–ç‰‡" 
                             class="w-full h-full ${imageClass}" 
                             onerror="this.onerror=null; this.src='https://placehold.co/800x400/555555/ffffff?text=${locationName} + åœ–ç‰‡ç¼ºå¤±'; this.classList.remove('img-cover-center'); this.classList.add('object-contain', 'p-4')"
                        >
                    </div>
                    <p class="text-xs text-gray-500 italic mt-1 text-right">åœ–ç‰‡è·¯å¾‘ (æœ¬åœ°)ï¼š${imageUrl}</p>
                `;
            } else {
                imageHtml = `<div class="h-48 bg-gray-700 rounded-xl flex items-center justify-center text-gray-400 font-semibold text-xl shadow-inner border border-gray-600">[åœ°é»ç…§ç‰‡]</div>`;
            }

            // æ–°å¢ã€Œæœ€ä½³åƒè§€æ™‚é–“ã€å€å¡Šçš„ HTML
            let timingHtml = '';
            if (timing) {
                timingHtml = `
                    <h2 class="text-2xl font-bold text-text-light pt-4 border-t border-gray-700">ğŸ§­ æœ€ä½³åƒè§€æ™‚é–“</h2>
                    <div class="p-4 bg-accent/20 border-l-4 border-accent rounded-xl text-lg shadow-md">
                        <p class="text-text-light">${timing}</p>
                    </div>
                `;
            }

            // ã€æ–°å¢ã€‘ã€Œåœ°é»åœ°åœ–ã€å€å¡Šçš„ HTML
            let mapHtml = '';
            if (mapUrl) {
                mapHtml = `
                    <h2 class="text-2xl font-bold text-text-light pt-4 border-t border-gray-700">ğŸ—ºï¸ åœ°é»åœ°åœ–</h2>
                    <div class="h-80 w-full overflow-hidden rounded-xl shadow-xl border-4 border-accent/50 bg-bg-mid-card">
                        <iframe src="${mapUrl}" 
                                width="100%" height="100%" style="border:0;" 
                                allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade" 
                                class="rounded-lg">
                        </iframe>
                    </div>
                    <p class="text-sm text-gray-400 italic mt-2">è«‹æ³¨æ„ï¼šåœ°åœ–é¡¯ç¤ºç‚ºæ¦‚ç•¥ä½ç½®ï¼Œæ‚¨å¯ä»¥ç·¨è¼¯ç¨‹å¼ç¢¼ä¸­çš„ **map_url** æ¬„ä½ä¾†ä¿®æ”¹åœ°åœ–é€£çµã€‚</p>
                `;
            }

            const content = `
                <header class="mb-8 border-b-2 border-accent/50 pb-4">
                    <!-- æ¨™é¡Œæ”¹ç‚º text-text-light -->
                    <h1 class="text-4xl font-extragold text-text-light mb-2">${locationName}</h1>
                    <!-- å‰¯æ¨™é¡Œæ”¹ç‚º text-text-light -->
                    <p class="text-lg text-text-light font-medium">ä¸»é¡Œåˆ†é¡ï¼š${data.categoryName}</p>
                </header>

                <div class="text-lg leading-relaxed text-text-light space-y-6">
                    ${imageHtml}
                    
                    <h2 class="text-2xl font-bold text-text-light pt-4 border-t border-gray-700">åœ°é»ä»‹ç´¹</h2>
                    <p class="text-text-light">${detail}</p>
                    
                    <!-- æ’å…¥æœ€ä½³åƒè§€æ™‚é–“ -->
                    ${timingHtml}
                    
                    <!-- ã€æ–°å¢ã€‘æ’å…¥åœ°é»åœ°åœ– -->
                    ${mapHtml}

                    <div class="p-4 bg-yellow-900/30 border-l-4 border-yellow-600 rounded-xl italic text-base shadow-sm">
                        <p class="font-semibold text-yellow-300 mb-1">ğŸ’¡ ç·¨è¼¯æç¤ºï¼š</p>
                        <p class="text-yellow-400">æ‚¨å¯ä»¥ç·¨è¼¯ç¨‹å¼ç¢¼ä¸­çš„ "MUSEUM_DATA" ä¾†ä¿®æ”¹é€™æ®µä»‹ç´¹æ–‡å­—æˆ–æ™‚é–“è³‡è¨Šã€‚</p>
                    </div>
                </div>
            `;
            appContent.insertAdjacentHTML('beforeend', content);
        }

        // ã€æ–°å¢ã€‘è·¯ç·šè¦åŠƒå…¥å£è¦–åœ–
        function renderRoutePlanningEntry(data) {
            const { categoryName } = data;
            
            // å–å¾—æ‰€æœ‰ä¸»é¡Œåœ°é»
            const localIndustryLocations = MUSEUM_DATA[categoryName];
            const locationOptions = Object.keys(localIndustryLocations).map(locName => {
                // ç›®çš„åœ°åç¨±ä½¿ç”¨åœ°é»åç¨±ï¼Œå€¼ä½¿ç”¨åœ°é»åç¨±+æè¿°çš„å‰ç¶´ï¼Œç¢ºä¿å¯è­˜åˆ¥ä¸”å¯ç·¨ç¢¼
                return `<option value="${locName}">${locName}</option>`; 
            }).join('');

            const content = `
                <header class="mb-8 border-b-2 border-accent/50 pb-4">
                    <h1 class="text-4xl font-extrabold text-text-light mb-2">${categoryName} è·¯ç·šè¦åŠƒ</h1>
                    <p class="text-lg text-text-light font-medium">å¾æ‚¨çš„ä½ç½®å‰å¾€ ${categoryName} åœ°é»ã€‚</p>
                </header>

                <div class="space-y-6 p-6 bg-bg-mid-card rounded-xl shadow-xl">
                    <label for="destination-select" class="block text-xl font-medium text-text-light">
                        1. é¸æ“‡ç›®çš„åœ°ï¼š
                    </label>
                    
                    <!-- åœ°é»é¸å–® -->
                    <select id="destination-select" 
                            onchange="updatePlanButton()"
                            class="w-full p-3 border border-gray-500 rounded-lg shadow-sm focus:ring-accent focus:border-accent bg-bg-card text-text-light text-base appearance-none transition duration-150 ease-in-out cursor-pointer">
                        <option value="" disabled selected>è«‹é¸æ“‡ä¸€å€‹åœ°é»...</option>
                        ${locationOptions}
                    </select>

                    <p class="text-lg font-medium text-text-light">
                        2. é»æ“ŠæŒ‰éˆ•åœ¨æ–°è¦–çª—ä¸­è¦åŠƒè·¯ç·šï¼š
                    </p>
                    
                    <!-- è·¯ç·šè¦åŠƒæŒ‰éˆ• -->
                    <button id="plan-route-button" 
                            disabled
                            onclick="planRoute()"
                            class="w-full flex justify-center items-center px-6 py-3 text-xl font-bold rounded-xl shadow-lg border-2 border-accent/50 text-text-light bg-accent/80 hover:bg-accent disabled:bg-gray-600 disabled:text-gray-400 disabled:cursor-not-allowed transition duration-150 ease-in-out transform hover:scale-[1.01] focus:outline-none focus:ring-4 focus:ring-accent/50">
                        <svg class="h-6 w-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.727A8 8 0 016.343 15.273L4 17l.868.868a2 2 0 112.828 2.828L12 22l4.132-4.132a2 2 0 112.828-2.828L20 17l-2.343-2.273zM12 11V3m0 0l3 3m-3-3l-3 3"></path></svg>
                        é–‹å•Ÿ Google åœ°åœ–å°èˆª
                    </button>
                    
                    <!-- è¨Šæ¯æç¤º -->
                    <div id="route-message" class="p-3 text-sm rounded-lg bg-yellow-900/30 border-l-4 border-yellow-600 text-yellow-300">
                        è«‹é¸æ“‡ç›®çš„åœ°ä»¥å•Ÿç”¨è·¯ç·šè¦åŠƒæŒ‰éˆ•ã€‚è¦åŠƒå°‡ä»¥æ‚¨çš„ç•¶å‰ä½ç½®ç‚ºèµ·é»ã€‚
                    </div>
                </div>
            `;
            appContent.insertAdjacentHTML('beforeend', content);
        }

        // ã€æ–°å¢ã€‘æ›´æ–°è¦åŠƒæŒ‰éˆ•ç‹€æ…‹
        function updatePlanButton() {
            const select = document.getElementById('destination-select');
            const button = document.getElementById('plan-route-button');
            const message = document.getElementById('route-message');
            
            if (select && button && message) {
                if (select.value) {
                    button.disabled = false;
                    message.innerHTML = `å·²é¸æ“‡ç›®çš„åœ°ï¼š<span class="font-semibold">${select.options[select.selectedIndex].text}</span>ã€‚é»æ“ŠæŒ‰éˆ•åœ¨æ–°è¦–çª—ä¸­é–‹å•Ÿ Google åœ°åœ–ã€‚`;
                    message.classList.remove('bg-yellow-900/30', 'border-yellow-600', 'text-yellow-300');
                    message.classList.add('bg-green-900/30', 'border-green-600', 'text-green-300');
                } else {
                    button.disabled = true;
                    message.innerHTML = 'è«‹é¸æ“‡ç›®çš„åœ°ä»¥å•Ÿç”¨è·¯ç·šè¦åŠƒæŒ‰éˆ•ã€‚è¦åŠƒå°‡ä»¥æ‚¨çš„ç•¶å‰ä½ç½®ç‚ºèµ·é»ã€‚';
                    message.classList.remove('bg-green-900/30', 'border-green-600', 'text-green-300');
                    message.classList.add('bg-yellow-900/30', 'border-yellow-600', 'text-yellow-300');
                }
            }
        }

        // ã€æ–°å¢ã€‘åŸ·è¡Œè·¯ç·šè¦åŠƒ
        function planRoute() {
            const select = document.getElementById('destination-select');
            const selectedText = select.options[select.selectedIndex].text;
            const message = document.getElementById('route-message');

            if (!select.value) {
                 message.innerHTML = 'âŒ è«‹å…ˆé¸æ“‡ä¸€å€‹æœ‰æ•ˆåœ°é»ã€‚';
                 message.classList.remove('bg-yellow-900/30', 'border-yellow-600', 'text-yellow-300', 'bg-green-900/30', 'border-green-600', 'text-green-300');
                 message.classList.add('bg-red-900/30', 'border-red-600', 'text-red-300');
                return;
            }
// ã€æ–°å¢ã€‘ç•™è¨€è™•ç†å‡½å¼ (ç”±æ–¼æ²’æœ‰å¾Œç«¯ï¼Œé€™è£¡åªæœƒå½ˆå‡ºæç¤º)
function handleMessageSubmit(event) {
    event.preventDefault(); // é˜»æ­¢è¡¨å–®å¯¦éš›æäº¤ (é¿å…é é¢é‡æ–°è¼‰å…¥)

    const nameInput = document.getElementById('message-name').value || 'åŒ¿åè¨ªå®¢';
    const contentInput = document.getElementById('message-content').value;

    if (contentInput.trim() === '') {
        alert('âŒ ç•™è¨€å…§å®¹ä¸èƒ½ç‚ºç©ºï¼');
        return;
    }

    // æ¨¡æ“¬ç•™è¨€æˆåŠŸ (ä½¿ç”¨ alert æç¤º)
    alert(`æ„Ÿè¬ ${nameInput} çš„ç•™è¨€ï¼\n\næ‚¨çš„ç•™è¨€å·²ã€ŒæˆåŠŸæ¥æ”¶ã€ï¼ˆå‰ç«¯æ¨¡æ“¬ï¼‰ã€‚\n\nå¯¦éš›ç•™è¨€å…§å®¹ï¼š"${contentInput.substring(0, 50)}..."`);

    // æ¸…ç©ºè¡¨å–®
    document.getElementById('message-form').reset();
}

            // ç›®çš„åœ°ä½¿ç”¨é¸å–®ä¸­çš„åœ°é»åç¨±ä½œç‚ºæŸ¥è©¢å­—ä¸²
            const destinationName = select.value; 
            const encodedDestination = encodeURIComponent(destinationName);

            // Google Maps è·¯ç·šè¦åŠƒ URL
            const mapsUrl = `https://www.google.com/maps/dir/?api=1&destination=${encodedDestination}&travelmode=driving`;

            // åœ¨æ–°åˆ†é ä¸­é–‹å•Ÿåœ°åœ–
            window.open(mapsUrl, '_blank');

            // é¡¯ç¤ºæˆåŠŸæ¶ˆæ¯
            message.innerHTML = `âœ… å·²ç‚º <span class="font-semibold">${selectedText}</span> é–‹å•Ÿ Google åœ°åœ–è¦åŠƒè·¯ç·šï¼`;
            message.classList.remove('bg-yellow-900/30', 'border-yellow-600', 'text-yellow-300', 'bg-red-900/30', 'border-red-600', 'text-red-300');
            message.classList.add('bg-green-900/30', 'border-green-600', 'text-green-300');
        }


        document.addEventListener('DOMContentLoaded', () => {
            navigateTo('landing');
        });
    </script>
</body>
</html>